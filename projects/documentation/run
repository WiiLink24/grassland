#!/usr/bin/env nu

let script_directory_path = $env.CURRENT_FILE | path dirname

# Handle the meta files of the monorepo
def main [] {
    cd $script_directory_path

    .venv/bin/mkdocs serve
}

# Setup the environment of the documentation
def "main setup" [] {
    cd $script_directory_path

    rm -rf .venv
    python3 -m venv .venv

    .venv/bin/pip3 install -r requirements.txt
}

# Create a new docker image for the documentation
def "main docker build" [
    tag: string # The tag to be added to the image
] {
    cd $script_directory_path

    docker build -t $"ghcr.io/WiiLink24/documentation:($tag)" .
}